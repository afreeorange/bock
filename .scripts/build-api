#!/bin/bash

source .scripts/common

echo "ğŸ§¹ Cleaning up"
rm -rf dist

echo "ğŸ‘·â€â™€ï¸ Building wheel and source tarball"

if [[ ! -e bock/ui/cached_dist ]]; then
    echo "âŒ Looks like you haven't built the UI. Quitting."
fi

echo "ğŸ‘‰ Moving node_modules to $NODE_MODULES_TEMP"
mv bock/ui/node_modules "$NODE_MODULES_TEMP"

poetry install
poetry build -vvv

echo "ğŸ‘ˆ Restoring node_modules"
mv "$NODE_MODULES_TEMP" bock/ui/node_modules

echo "ğŸš€ Finished API"
